<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@1,500;1,800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <title>TEACHER PORTAL</title>
    <style>
           body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: #e0d4cb;
            color: #333;
            transition: background 0.5s ease;
        }

        header {
            background: linear-gradient(to right, #b39ddb, #9575cd);
            color: #333;
            text-align: center;
            padding: 15px;
            margin-bottom: 20px;
            transition: background 0.5s ease;
            font-family: 'Exo 2', sans-serif;
        }

        header:hover {
            background-color: #7e57c2;
        }

        section {
            font-family: 'Exo 2', sans-serif;
            font-size: 18px;
            margin: auto;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            animation: fadeInUp 0.8s ease;
            transition: background 0.5s ease;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            max-height: 120vh;
            margin-top: 20px;
        }

        .input-container {
            text-align: center;
            margin-top: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 201px;
            margin: auto;
        }

        .student-info {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            line-height: 1.5;
        }

        .a1 {
            margin-top: 10px;
            display: flex;
            flex-direction: row;
            margin-bottom: 50px;
            justify-content: center;
        }

        .b {
            height: 50px;
            width: 80px;
            margin-left: 10px;
            margin-right: 80px;
            font-size: 18px;
            border: 2px solid #673ab7;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: border 0.3s ease, box-shadow 0.3s ease;
        }

        .b:focus {
            border-color: #512da8;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .bl {
            margin-left: 10px;
        }

        .tc {
            width: 90px;
        }

        .btn {
            font-size: larger;
            margin-left: 40%;
            margin-bottom: 20px;
            font-family: 'Exo 2', sans-serif;
        }

        form label,
        form input {
            display: block;
            margin: 10px 0;
            transition: background 0.5s ease;
        }

        form button {
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            transition: background 0.5s ease;
        }

        table {
            border-collapse: collapse;
            margin-top: 20px;
            width: 90%;
            font-size: 16px;
            letter-spacing: 0.05px;
            border-radius: 10px;
            overflow: hidden;
            margin: auto;
        }

        th,
        td {
            border: 1px solid #ddd;
            text-align: left;
            padding: 20px;
            font-size: 20px; /* Increased font size for marks in the table */
        }

        th {
            background-color: #9575cd;
            color: #fff;
        }

        /* Additional styling for max marks label */
        .max-marks {
            font-size: 14px;
            color: #555;
        }
    </style>
</head>

<body>
    <script>
        const code = '<%= a.subject %>';

        // Function to convert subject code to full name
        function getSubjectFullName(code) {
            switch (code) {
                case 'MATHS':
                    return 'Mathematics';
                case 'OS':
                    return 'Operating System';
                case 'ADLDCO':
                    return 'Applied Digital Logic Design';
                // Add more cases for other subject codes as needed
                default:
                    return code;
            }
        }

        // Display full subject name in the header
        document.addEventListener('DOMContentLoaded', function () {
            const header = document.querySelector('header h1');
            if (header) {
                header.innerText = getSubjectFullName(code);
            }
        });
    </script>

    <header>
        <h1></h1>
    </header>
    <div class="input-container">
        <% if (data ) { %>
            <div id="student-info" class="student-info">
                <span>Name: <%= data.Name %></span><br>
                <span>USN: <%= data.USN %></span>
            </div>
        <% } else { %>
            <div style="display: none;"></div>
        <% } %>
    </div>
    <section>
        <form id="dataForm" action="/updateMarks" method="POST">
            <input type="hidden" id="usn" name="usn" value="<%= data.USN %>">
            <div class="a1">
                <div class="a">
        <label for="q1" class="bl">Quiz1:</label>
        <input type="number" id="q1" name="q1" required class="b" max="10">
        <span class="max-marks">/10</span>
    </div>
    <div class="a">
        <label for="q2" class="bl">Quiz2:</label>
        <input type="number" id="q2" name="q2" required class="b" max="10">
        <span class="max-marks">/10</span>
    </div>
    <div class="a">
        <label for="t1" class="bl">Test1:</label>
        <input type="number" id="t1" name="t1" required class="b" max="50">
        <span class="max-marks">/50</span>
    </div>
    <div class="a">
        <label for="t2" class="bl">Test2:</label>
        <input type="number" id="t2" name="t2" required class="b" max="50">
        <span class="max-marks">/50</span>
    </div>
                <div class="a">
                    <label for="TotalClasses">Total Classes Held:</label>
                    <input type="number" id="TotalClasses" name="TotalClasses" required class="b tc" min="0">
                </div></t>
                <div class="a">
                    <label for="AttendedClasses" >Total Classes Attended:</label>
                    <input type="number" id="AttendedClasses" name="AttendedClasses" required class="b tc" min="0" max="classesHeld">
                </div>
            </div>
            <div class="submit">
                <button type="submit" onclick="redirectToAddStudent()" class="btn btn-outline-danger">Update Marks</button>
            </form>
            </div>

            
        <table id="dataTable">
            <thead>
                <tr>
                    <th>Q1</th>
                    <th>Q2</th>
                    <th>T1</th>
                    <th>T2</th>
                    <th>QTotal</th>
                    <th>Test-Total</th>
                    <th>Quiz Average</th>
                    <th>Test Average</th>
                    <th>Total Classes</th>
                    <th>Attended Classes</th>
                    <th>Attendance Percentage</th>
                </tr>
            </thead>
           <tbody>
 <% const selectedSubject = a.subject || ''; %>

<% if (data.Subjects && data.Subjects[selectedSubject]) { %>
    <tr>
        <td><%= data.Subjects[selectedSubject].q1 || 'N/A' %></td>
        <td><%= data.Subjects[selectedSubject].q2 || 'N/A' %></td>
        <td><%= data.Subjects[selectedSubject].t1 || 'N/A' %></td>
        <td><%= data.Subjects[selectedSubject].t2 || 'N/A' %></td>
        <!-- Add calculations for QTotal and Test-Total -->
        <td><%= (parseFloat(data.Subjects[selectedSubject].q1) || 0) + (parseFloat(data.Subjects[selectedSubject].q2) || 0) %></td>
        <td><%= (parseFloat(data.Subjects[selectedSubject].q1) || 0) + (parseFloat(data.Subjects[selectedSubject].q2) || 0) + (parseFloat(data.Subjects[selectedSubject].t1) || 0) + (parseFloat(data.Subjects[selectedSubject].t2) || 0) %></td>

        <!-- Additional Columns for Quiz Average, Test Average, Total Classes, Attended Classes, and Attendance Percentage -->
        <td>
            <% if (data.Subjects[selectedSubject].q1 !== undefined && data.Subjects[selectedSubject].q2 !== undefined) { %>
                <%= ((parseFloat(data.Subjects[selectedSubject].q1) + parseFloat(data.Subjects[selectedSubject].q2)) / 2).toFixed(2) %>
            <% } else { %>
                N/A
            <% } %>
        </td>
        <td>
            <% if (data.Subjects[selectedSubject].t1 !== undefined && data.Subjects[selectedSubject].t2 !== undefined) { %>
                <%= ((parseFloat(data.Subjects[selectedSubject].t1) + parseFloat(data.Subjects[selectedSubject].t2)) / 2).toFixed(2) %>
            <% } else { %>
                N/A
            <% } %>
        </td>
        <td><%= data.Subjects[selectedSubject].TotalClasses || 'N/A'  %></td> <!-- You need to calculate and set 'TotalClasses' in your server-side logic -->
        <td><%= data.Subjects[selectedSubject].AttendedClasses || 'N/A'  %></td> <!-- You need to calculate and set 'AttendedClasses' in your server-side logic -->
        <td>
            <% if (data.AttendancePercentage !== undefined) { %>
                <%= data.AttendancePercentage.toFixed(2) %>
            <% } else { %>
                N/A
            <% } %>
            %
        </td>
    </tr>
<% } else { %>
    <tr>
        <td colspan="11">No data available for <%= selectedSubject %></td>
    </tr>
<% } %>


</tbody>

        </table>
    </section>

        <script>
            function redirectToAddStudent() {
                window.location.href = '/updateMarks';
            }
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>

</html>
